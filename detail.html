<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8">
  <title>Detail Produk - GreenFresh</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    /* Card dikecilkan */
    .product-card img {
        height: 130px;
        object-fit: cover;
        border-radius: 6px;
    }

    .card {
        padding: 8px;
        border-radius: 10px;
    }

    #popupBeli {
        position: fixed;
        top: 0; left:0;
        width:100%; height:100%;
        background: rgba(0,0,0,0.5);
        display:none;
        justify-content:center;
        align-items:center;
    }

    .popup-box {
        background:white;
        padding:20px;
        border-radius:10px;
        width:280px;
    }
  </style>
</head>

<body class="bg-light">

<nav class="navbar navbar-expand-lg navbar-dark bg-success">
  <div class="container">
    <a class="navbar-brand" href="index.html">
      <img src="assets/images/logo.jpg" style="height:30px">
      GreenFresh
    </a>
  </div>
</nav>

<div class="container my-4">
    <h4 id="judulKategori" class="text-success mb-3"></h4>

    <!-- ðŸ” MENU PENCARIAN -->
    <input type="text" id="searchInput" class="form-control mb-3" placeholder="Cari produk di kategori ini...">

    <div class="row" id="listProduk"></div>
</div>

<!-- POPUP BELI -->
<div id="popupBeli">
  <div class="popup-box">
      <h5 id="namaProdukPopup"></h5>
      <label>Masukkan jumlah (kg):</label>
      <input type="number" id="jumlahKg" class="form-control mb-3" min="1">

      <button class="btn btn-success w-100 mb-2" onclick="confirmBeli()">Beli</button>
      <button class="btn btn-secondary w-100" onclick="closePopup()">Batal</button>
  </div>
</div>

<footer class="bg-success text-white text-center p-2 mt-4">
  Â©copyrigh by 23552011408_RIKA AZHAR_ TIF RP CNS B
</footer>

<script>
  // DATA PRODUK PER KATEGORI SESUAI GAMBAR KAMU
  const dataProduk = {
      sayur: [
          { nama: "Terong", harga: "Rp 12.000 / kg", stok: "Ada", gambar: "assets/images/terong.jpg" },
          { nama: "Wortel", harga: "Rp 10.000 / kg", stok: "Ada", gambar: "assets/images/wortel.jpg" },
          { nama: "Kol", harga: "Rp 9.000 / kg", stok: "Ada", gambar: "assets/images/kol.jpg" },
          { nama: "Cabai Merah", harga: "Rp 35.000 / kg", stok: "Habis", gambar: "assets/images/cabai.jpg" }
      ],

      buah: [
          { nama: "Apel", harga: "Rp 25.000 / kg", stok: "Ada", gambar: "assets/images/apel.jpg" },
          { nama: "Kiwi", harga: "Rp 40.000 / kg", stok: "Ada", gambar: "assets/images/kiwi.jpg" },
          { nama: "Nanas", harga: "Rp 15.000 / kg", stok: "Habis", gambar: "assets/images/nanas.jpg" },
          { nama: "Semangka", harga: "Rp 12.000 / kg", stok: "Ada", gambar: "assets/images/semangka.jpg" }
      ],

      rempah: [
          { nama: "Kencur", harga: "Rp 20.000 / 250gr", stok: "Ada", gambar: "assets/images/kencur.jpg" },
          { nama: "Kemiri", harga: "Rp 18.000 / 250gr", stok: "Ada", gambar: "assets/images/kemiri.jpg" },
          { nama: "Ketumbar", harga: "Rp 10.000 / 250gr", stok: "Habis", gambar: "assets/images/ketumbar.jpg" }
      ]
  };

  let produkDipilih = null;

  const params = new URLSearchParams(window.location.search);
  const kategori = params.get("type");

  const namaKategori = {
      sayur: "Daftar Sayuran Segar",
      buah: "Daftar Buah-Buahan",
      rempah: "Daftar Rempah & Bumbu Dapur"
  };

  document.getElementById("judulKategori").innerText = namaKategori[kategori];

  const listProduk = document.getElementById("listProduk");

  function renderProduk(filter = "") {
      listProduk.innerHTML = "";

      dataProduk[kategori].forEach(p => {
          if (p.nama.toLowerCase().includes(filter.toLowerCase())) {
              listProduk.innerHTML += `
                  <div class="col-6 col-md-3 mb-3 product-card">
                      <div class="card h-100">
                          <img src="${p.gambar}" class="card-img-top">
                          <div class="card-body p-2">
                              <h6 class="card-title">${p.nama}</h6>
                              <small>Harga: ${p.harga}</small><br>
                              <small>Stok: <b class="${p.stok === "Ada" ? "text-success" : "text-danger"}">${p.stok}</b></small>
                              <button class="btn btn-sm btn-success w-100 mt-2"
                                  onclick="openPopup('${p.nama}')"
                                  ${p.stok === "Habis" ? "disabled" : ""}>
                                  Beli
                              </button>
                          </div>
                      </div>
                  </div>
              `;
          }
      });
  }

  renderProduk();

  document.getElementById("searchInput").addEventListener("keyup", function() {
      renderProduk(this.value);
  });

  function openPopup(nama) {
      produkDipilih = nama;
      document.getElementById("namaProdukPopup").innerText = "Beli " + nama;
      document.getElementById("popupBeli").style.display = "flex";
  }

  function closePopup() {
      document.getElementById("popupBeli").style.display = "none";
  }

  function confirmBeli() {
      let jumlah = document.getElementById("jumlahKg").value;
      if (jumlah < 1) {
          alert("Jumlah tidak boleh kosong!");
          return;
      }

      alert("Pembelian berhasil! Anda membeli " + produkDipilih + " sebanyak " + jumlah + " kg");
      closePopup();
  }
</script>

</body>
</html>
